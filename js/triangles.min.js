/*!--------------------------------------------------------------------
minified ./triangles.js
-----------------------------------------------------------------------*/
var Delaunay;!function(){"use strict";function t(t){var e,i,n,r,o,s,h=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;for(e=t.length;e--;)t[e][0]<h&&(h=t[e][0]),t[e][0]>u&&(u=t[e][0]),t[e][1]<a&&(a=t[e][1]),t[e][1]>c&&(c=t[e][1]);return i=u-h,n=c-a,r=Math.max(i,n),o=h+.5*i,s=a+.5*n,[[o-20*r,s-r],[o,s+20*r],[o+20*r,s-r]]}function e(t,e,i,r){var o,s,h,a,u,c,l,f,S,d,m=t[e][0],p=t[e][1],F=t[i][0],g=t[i][1],y=t[r][0],b=t[r][1],v=Math.abs(p-g),w=Math.abs(g-b);if(v<n&&w<n)throw new Error("Eek! Coincident points!");return v<n?s=(a=-(y-F)/(b-g))*((o=(F+m)/2)-(c=(F+y)/2))+(f=(g+b)/2):w<n?s=(h=-(F-m)/(g-p))*((o=(y+F)/2)-(u=(m+F)/2))+(l=(p+g)/2):(o=((h=-(F-m)/(g-p))*(u=(m+F)/2)-(a=-(y-F)/(b-g))*(c=(F+y)/2)+(f=(g+b)/2)-(l=(p+g)/2))/(h-a),s=v>w?h*(o-u)+l:a*(o-c)+f),S=F-o,d=g-s,{i:e,j:i,k:r,x:o,y:s,r:S*S+d*d}}function i(t){var e,i,n,r,o,s;for(i=t.length;i;)for(r=t[--i],n=t[--i],e=i;e;)if(s=t[--e],o=t[--e],n===o&&r===s||n===s&&r===o){t.splice(i,2),t.splice(e,2);break}}var n=1/1048576;Delaunay={triangulate:function(r,o){var s,h,a,u,c,l,f,S,d,m,p,F,g=r.length;if(g<3)return[];if(r=r.slice(0),o)for(s=g;s--;)r[s]=r[s][o];for(a=new Array(g),s=g;s--;)a[s]=s;for(a.sort(function(t,e){return r[e][0]-r[t][0]}),u=t(r),r.push(u[0],u[1],u[2]),c=[e(r,g+0,g+1,g+2)],l=[],f=[],s=a.length;s--;f.length=0){for(F=a[s],h=c.length;h--;)(S=r[F][0]-c[h].x)>0&&S*S>c[h].r?(l.push(c[h]),c.splice(h,1)):S*S+(d=r[F][1]-c[h].y)*d-c[h].r>n||(f.push(c[h].i,c[h].j,c[h].j,c[h].k,c[h].k,c[h].i),c.splice(h,1));for(i(f),h=f.length;h;)p=f[--h],m=f[--h],c.push(e(r,m,p,F))}for(s=c.length;s--;)l.push(c[s]);for(c.length=0,s=l.length;s--;)l[s].i<g&&l[s].j<g&&l[s].k<g&&c.push(l[s].i,l[s].j,l[s].k);return c},contains:function(t,e){if(e[0]<t[0][0]&&e[0]<t[1][0]&&e[0]<t[2][0]||e[0]>t[0][0]&&e[0]>t[1][0]&&e[0]>t[2][0]||e[1]<t[0][1]&&e[1]<t[1][1]&&e[1]<t[2][1]||e[1]>t[0][1]&&e[1]>t[1][1]&&e[1]>t[2][1])return null;var i=t[1][0]-t[0][0],n=t[2][0]-t[0][0],r=t[1][1]-t[0][1],o=t[2][1]-t[0][1],s=i*o-n*r;if(0===s)return null;var h=(o*(e[0]-t[0][0])-n*(e[1]-t[0][1]))/s,a=(i*(e[1]-t[0][1])-r*(e[0]-t[0][0]))/s;return h<0||a<0||h+a>1?null:[h,a]}},"undefined"!=typeof module&&(module.exports=Delaunay)}(),FSS={FRONT:0,BACK:1,DOUBLE:2,SVGNS:"http://www.w3.org/2000/svg"},FSS.Array="function"==typeof Float32Array?Float32Array:Array,FSS.Utils={isNumber:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var n=(new Date).getTime(),r=Math.max(0,16-(n-t)),o=window.setTimeout(function(){e(n+r)},r);return t=n+r,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),Math.PIM2=2*Math.PI,Math.PID2=Math.PI/2,Math.randomInRange=function(t,e){return t+(e-t)*Math.random()},Math.clamp=function(t,e,i){return t=Math.max(t,e),t=Math.min(t,i)},FSS.Vector3={create:function(t,e,i){var n=new FSS.Array(3);return this.set(n,t,e,i),n},clone:function(t){var e=this.create();return this.copy(e,t),e},set:function(t,e,i,n){return t[0]=e||0,t[1]=i||0,t[2]=n||0,this},setX:function(t,e){return t[0]=e||0,this},setY:function(t,e){return t[1]=e||0,this},setZ:function(t,e){return t[2]=e||0,this},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],this},add:function(t,e){return t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],this},addVectors:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],this},addScalar:function(t,e){return t[0]+=e,t[1]+=e,t[2]+=e,this},subtract:function(t,e){return t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],this},subtractVectors:function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],this},subtractScalar:function(t,e){return t[0]-=e,t[1]-=e,t[2]-=e,this},multiply:function(t,e){return t[0]*=e[0],t[1]*=e[1],t[2]*=e[2],this},multiplyVectors:function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],this},multiplyScalar:function(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,this},divide:function(t,e){return t[0]/=e[0],t[1]/=e[1],t[2]/=e[2],this},divideVectors:function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],this},divideScalar:function(t,e){return 0!==e?(t[0]/=e,t[1]/=e,t[2]/=e):(t[0]=0,t[1]=0,t[2]=0),this},cross:function(t,e){var i=t[0],n=t[1],r=t[2];return t[0]=n*e[2]-r*e[1],t[1]=r*e[0]-i*e[2],t[2]=i*e[1]-n*e[0],this},crossVectors:function(t,e,i){return t[0]=e[1]*i[2]-e[2]*i[1],t[1]=e[2]*i[0]-e[0]*i[2],t[2]=e[0]*i[1]-e[1]*i[0],this},min:function(t,e){return t[0]<e&&(t[0]=e),t[1]<e&&(t[1]=e),t[2]<e&&(t[2]=e),this},max:function(t,e){return t[0]>e&&(t[0]=e),t[1]>e&&(t[1]=e),t[2]>e&&(t[2]=e),this},clamp:function(t,e,i){return this.min(t,e),this.max(t,i),this},limit:function(t,e,i){var n=this.length(t);return null!==e&&n<e?this.setLength(t,e):null!==i&&n>i&&this.setLength(t,i),this},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},normalise:function(t){return this.divideScalar(t,this.length(t))},negate:function(t){return this.multiplyScalar(t,-1)},distanceSquared:function(t,e){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2];return i*i+n*n+r*r},distance:function(t,e){return Math.sqrt(this.distanceSquared(t,e))},lengthSquared:function(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]},length:function(t){return Math.sqrt(this.lengthSquared(t))},setLength:function(t,e){var i=this.length(t);return 0!==i&&e!==i&&this.multiplyScalar(t,e/i),this}},FSS.Vector4={create:function(t,e,i,n){var r=new FSS.Array(4);return this.set(r,t,e,i),r},set:function(t,e,i,n,r){return t[0]=e||0,t[1]=i||0,t[2]=n||0,t[3]=r||0,this},setX:function(t,e){return t[0]=e||0,this},setY:function(t,e){return t[1]=e||0,this},setZ:function(t,e){return t[2]=e||0,this},setW:function(t,e){return t[3]=e||0,this},add:function(t,e){return t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t[3]+=e[3],this},multiplyVectors:function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],this},multiplyScalar:function(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,this},min:function(t,e){return t[0]<e&&(t[0]=e),t[1]<e&&(t[1]=e),t[2]<e&&(t[2]=e),t[3]<e&&(t[3]=e),this},max:function(t,e){return t[0]>e&&(t[0]=e),t[1]>e&&(t[1]=e),t[2]>e&&(t[2]=e),t[3]>e&&(t[3]=e),this},clamp:function(t,e,i){return this.min(t,e),this.max(t,i),this}},FSS.Color=function(t,e){this.rgba=FSS.Vector4.create(),this.hex=t||"#000000",this.opacity=FSS.Utils.isNumber(e)?e:1,this.set(this.hex,this.opacity)},FSS.Color.prototype={set:function(t,e){var i=(t=t.replace("#","")).length/3;return this.rgba[0]=parseInt(t.substring(0*i,1*i),16)/255,this.rgba[1]=parseInt(t.substring(1*i,2*i),16)/255,this.rgba[2]=parseInt(t.substring(2*i,3*i),16)/255,this.rgba[3]=FSS.Utils.isNumber(e)?e:this.rgba[3],this},hexify:function(t){var e=Math.ceil(255*t).toString(16);return 1===e.length&&(e="0"+e),e},format:function(){var t=this.hexify(this.rgba[0]),e=this.hexify(this.rgba[1]),i=this.hexify(this.rgba[2]);return this.hex="#"+t+e+i,this.hex}},FSS.Object=function(){this.position=FSS.Vector3.create()},FSS.Object.prototype={setPosition:function(t,e,i){return FSS.Vector3.set(this.position,t,e,i),this}},FSS.Light=function(t,e){FSS.Object.call(this),this.ambient=new FSS.Color(t||"#FFFFFF"),this.diffuse=new FSS.Color(e||"#FFFFFF"),this.ray=FSS.Vector3.create()},FSS.Light.prototype=Object.create(FSS.Object.prototype),FSS.Vertex=function(t,e,i){this.position=FSS.Vector3.create(t,e,i)},FSS.Vertex.prototype={setPosition:function(t,e,i){return FSS.Vector3.set(this.position,t,e,i),this}},FSS.Triangle=function(t,e,i){this.a=t||new FSS.Vertex,this.b=e||new FSS.Vertex,this.c=i||new FSS.Vertex,this.vertices=[this.a,this.b,this.c],this.u=FSS.Vector3.create(),this.v=FSS.Vector3.create(),this.centroid=FSS.Vector3.create(),this.normal=FSS.Vector3.create(),this.color=new FSS.Color,this.polygon=document.createElementNS(FSS.SVGNS,"polygon"),this.polygon.setAttributeNS(null,"stroke-linejoin","round"),this.polygon.setAttributeNS(null,"stroke-miterlimit","1"),this.polygon.setAttributeNS(null,"stroke-width","1"),this.computeCentroid(),this.computeNormal()},FSS.Triangle.prototype={computeCentroid:function(){return this.centroid[0]=this.a.position[0]+this.b.position[0]+this.c.position[0],this.centroid[1]=this.a.position[1]+this.b.position[1]+this.c.position[1],this.centroid[2]=this.a.position[2]+this.b.position[2]+this.c.position[2],FSS.Vector3.divideScalar(this.centroid,3),this},computeNormal:function(){return FSS.Vector3.subtractVectors(this.u,this.b.position,this.a.position),FSS.Vector3.subtractVectors(this.v,this.c.position,this.a.position),FSS.Vector3.crossVectors(this.normal,this.u,this.v),FSS.Vector3.normalise(this.normal),this}},FSS.Geometry=function(){this.vertices=[],this.triangles=[],this.dirty=!1},FSS.Geometry.prototype={update:function(){if(this.dirty){var t,e;for(t=this.triangles.length-1;t>=0;t--)(e=this.triangles[t]).computeCentroid(),e.computeNormal();this.dirty=!1}return this}},FSS.Plane=function(t,e,i){FSS.Geometry.call(this),this.width=t||100,this.height=e||100;var n,r,o=new Array(i);for(offsetX=-.5*this.width,offsetY=.5*this.height,s=o.length;s--;)n=offsetX+Math.random()*t,r=offsetY-Math.random()*e,o[s]=[n,r];o.push([offsetX,offsetY]),o.push([offsetX+t/2,offsetY]),o.push([offsetX+t,offsetY]),o.push([offsetX+t,offsetY-e/2]),o.push([offsetX+t,offsetY-e]),o.push([offsetX+t/2,offsetY-e]),o.push([offsetX,offsetY-e]),o.push([offsetX,offsetY-e/2]);for(var s=6;s>=0;s--)o.push([offsetX+Math.random()*t,offsetY]),o.push([offsetX,offsetY-Math.random()*e]),o.push([offsetX+t,offsetY-Math.random()*e]),o.push([offsetX+Math.random()*t,offsetY-e]);var h=Delaunay.triangulate(o);for(s=h.length;s;)--s,v1=new FSS.Vertex(Math.ceil(o[h[s]][0]),Math.ceil(o[h[s]][1])),--s,v2=new FSS.Vertex(Math.ceil(o[h[s]][0]),Math.ceil(o[h[s]][1])),--s,v3=new FSS.Vertex(Math.ceil(o[h[s]][0]),Math.ceil(o[h[s]][1])),t1=new FSS.Triangle(v1,v2,v3),this.triangles.push(t1),this.vertices.push(v1),this.vertices.push(v2),this.vertices.push(v3)},FSS.Plane.prototype=Object.create(FSS.Geometry.prototype),FSS.Material=function(t,e){this.ambient=new FSS.Color(t||"#444444"),this.diffuse=new FSS.Color(e||"#FFFFFF"),this.slave=new FSS.Color},FSS.Mesh=function(t,e){FSS.Object.call(this),this.geometry=t||new FSS.Geometry,this.material=e||new FSS.Material,this.side=FSS.FRONT,this.visible=!0},FSS.Mesh.prototype=Object.create(FSS.Object.prototype),FSS.Mesh.prototype.update=function(t,e){var i,n,r,o,s;if(this.geometry.update(),e)for(i=this.geometry.triangles.length-1;i>=0;i--){for(n=this.geometry.triangles[i],FSS.Vector4.set(n.color.rgba),r=t.length-1;r>=0;r--)o=t[r],FSS.Vector3.subtractVectors(o.ray,o.position,n.centroid),FSS.Vector3.normalise(o.ray),s=FSS.Vector3.dot(n.normal,o.ray),this.side===FSS.FRONT?s=Math.max(s,0):this.side===FSS.BACK?s=Math.abs(Math.min(s,0)):this.side===FSS.DOUBLE&&(s=Math.max(Math.abs(s),0)),FSS.Vector4.multiplyVectors(this.material.slave.rgba,this.material.ambient.rgba,o.ambient.rgba),FSS.Vector4.add(n.color.rgba,this.material.slave.rgba),FSS.Vector4.multiplyVectors(this.material.slave.rgba,this.material.diffuse.rgba,o.diffuse.rgba),FSS.Vector4.multiplyScalar(this.material.slave.rgba,s),FSS.Vector4.add(n.color.rgba,this.material.slave.rgba);FSS.Vector4.clamp(n.color.rgba,0,1)}return this},FSS.Scene=function(){this.meshes=[],this.lights=[]},FSS.Scene.prototype={add:function(t){return t instanceof FSS.Mesh&&!~this.meshes.indexOf(t)?this.meshes.push(t):t instanceof FSS.Light&&!~this.lights.indexOf(t)&&this.lights.push(t),this},remove:function(t){return t instanceof FSS.Mesh&&~this.meshes.indexOf(t)?this.meshes.splice(this.meshes.indexOf(t),1):t instanceof FSS.Light&&~this.lights.indexOf(t)&&this.lights.splice(this.lights.indexOf(t),1),this}},FSS.Renderer=function(){this.width=0,this.height=0,this.halfWidth=0,this.halfHeight=0},FSS.Renderer.prototype={setSize:function(t,e){if(this.width!==t||this.height!==e)return this.width=t,this.height=e,this.halfWidth=.5*this.width,this.halfHeight=.5*this.height,this},clear:function(){return this},render:function(t){return this}},FSS.SVGRenderer=function(){FSS.Renderer.call(this),this.element=document.createElementNS(FSS.SVGNS,"svg"),this.element.setAttribute("xmlns",FSS.SVGNS),this.element.setAttribute("version","1.1"),this.element.style.display="block",this.setSize(300,150)},FSS.SVGRenderer.prototype=Object.create(FSS.Renderer.prototype),FSS.SVGRenderer.prototype.setSize=function(t,e){return FSS.Renderer.prototype.setSize.call(this,t,e),this.element.setAttribute("width",t),this.element.setAttribute("height",e),this},FSS.SVGRenderer.prototype.clear=function(){FSS.Renderer.prototype.clear.call(this);for(var t=this.element.childNodes.length-1;t>=0;t--)this.element.removeChild(this.element.childNodes[t]);return this},FSS.SVGRenderer.prototype.render=function(t){FSS.Renderer.prototype.render.call(this,t);var e,i,n,r,o,s;for(e=t.meshes.length-1;e>=0;e--)if((i=t.meshes[e]).visible)for(i.update(t.lights,!0),n=i.geometry.triangles.length-1;n>=0;n--)(r=i.geometry.triangles[n]).polygon.parentNode!==this.element&&this.element.appendChild(r.polygon),o=this.formatPoint(r.a)+" ",o+=this.formatPoint(r.b)+" ",o+=this.formatPoint(r.c),s=this.formatStyle(r.color.format()),r.polygon.setAttributeNS(null,"points",o),r.polygon.setAttributeNS(null,"style",s);return this},FSS.SVGRenderer.prototype.formatPoint=function(t){return this.halfWidth+t.position[0]+","+(this.halfHeight-t.position[1])},FSS.SVGRenderer.prototype.formatStyle=function(t){var e="fill:"+t+";";return e+="stroke:"+t+";"},function(){function t(){g=new FSS.SVGRenderer,e()}function e(){S&&V.removeChild(S.element),(S=g).setSize(w.offsetWidth,w.offsetHeight),V.appendChild(S.element)}function i(){d=new FSS.Scene}function n(){d.remove(m),S.clear(),p=new FSS.Plane(y.width*S.width,y.height*S.height,y.slices),F=new FSS.Material(y.ambient,y.diffuse),m=new FSS.Mesh(p,F),d.add(m);var t,e;for(t=p.vertices.length-1;t>=0;t--)(e=p.vertices[t]).depth=Math.randomInRange(0,y.maxdepth/10),e.anchor=FSS.Vector3.clone(e.position)}function r(t,e,i,n,r){t=void 0!==t?t:b.ambient,e=void 0!==e?e:b.diffuse,i=void 0!==i?i:b.xPos,n=void 0!==n?n:b.yPos,r=void 0!==r?r:b.zOffset,S.clear(),light=new FSS.Light(t,e),light.ambientHex=light.ambient.format(),light.diffuseHex=light.diffuse.format(),light.setPosition(i,n,r),d.add(light),b.diffuse=e,b.proxy=light,b.pickedup=!0,b.currIndex++}function o(t){for(var e=(t||Math.floor(4*Math.random())+1)-1;e>=0;e--)r(),b.count++}function s(t,e){S.setSize(t,e),FSS.Vector3.set(v,S.halfWidth,S.halfHeight),n()}function h(){a(),u(),requestAnimationFrame(h)}function a(){var t,e,i=y.depth/100;for(t=p.vertices.length-1;t>=0;t--)e=p.vertices[t],FSS.Vector3.set(e.position,1,1,e.depth*i),FSS.Vector3.add(e.position,e.anchor);p.dirty=!0}function u(){S.render(d)}function c(){w.addEventListener("mousemove",f)}function f(t){b.pickedup&&(b.xPos=(t.x||t.clientX)-S.width/2,b.yPos=S.height/2-(t.y||t.clientY),b.proxy.setPosition(b.xPos,b.yPos,b.proxy.position[2]))}var S,d,m,p,F,g,y={width:1.2,height:1.2,slices:250,depth:0,maxdepth:200,ambient:"#555555",diffuse:"#FFFFFF"},b={count:0,xPos:0,yPos:200,zOffset:100,ambient:"#FFFFFF",diffuse:"#5dc76f",pickedup:!0,proxy:!1,currIndex:0,randomize:function(){var t,e,i,n=Math.floor(3*Math.random())+1;for(1==n&&(y.depth=Math.randomInRange(100,133)),2==n&&(y.depth=Math.randomInRange(133,166)),3==n&&(y.depth=Math.randomInRange(166,200)),l=d.lights.length-1;l>=0;l--){t=Math.randomInRange(-m.geometry.width/2,m.geometry.width/2),e=Math.randomInRange(-m.geometry.height/2,m.geometry.height/2),i=d.lights.length>2?Math.randomInRange(10,80):Math.randomInRange(10,100),light=d.lights[l],FSS.Vector3.set(light.position,t,e,i);var r=b.diffuse,o=b.ambient;light.diffuse.set(r),light.diffuseHex=light.diffuse.format(),light.ambient.set(o),light.ambientHex=light.ambient.format(),b.xPos=t,b.yPos=e,b.zOffset=i,b.diffuse=r,b.ambient=o}}},v=FSS.Vector3.create(),w=document.getElementById("header-triangles-wrapper"),V=document.getElementById("output"),M=1;!function(){t(),i(),n(),o(M),c(),b.randomize(),s(w.offsetWidth,w.offsetHeight),h()}()}();
